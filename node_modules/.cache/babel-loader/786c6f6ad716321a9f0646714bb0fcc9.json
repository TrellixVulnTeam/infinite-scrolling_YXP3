{"ast":null,"code":"var _jsxFileName = \"/media/harshiiet/File_Space 1/Work_Study/WD/React/venueMonk/infinite-scrolling/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport loadingGif from \"./loading.gif\";\nimport \"./style/App.scss\";\nimport PhotoCard from \"./PhotoCard\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [photos, setPhotos] = useState([]);\n  const [term, setTerm] = useState(\"\");\n  const [pageNumber, setPageNumber] = useState(1);\n  const [termErr, setTermErr] = useState(\"\");\n  const [loading, setLoading] = useState(false); // attach to the element at the end of the page (loading_gif, button)\n\n  const pageEnd = useRef(); //count page loading content\n\n  const loadMore = () => {\n    setPageNumber(prevPageNumber => prevPageNumber + 1);\n    fetchPhotos(term, pageNumber);\n    console.log(pageNumber);\n  };\n\n  let num = 1;\n  useEffect(() => {\n    if (loading) {\n      const observer = new IntersectionObserver(entries => {\n        if (entries[0].isIntersecting) {\n          // console.log(\"this is the end\");\n          num++; // having trouble with loadMore()*\n\n          setPageNumber(prevPageNumber => prevPageNumber + 1);\n          fetchPhotos(term, pageNumber);\n\n          if (num >= 5) {\n            observer.unobserve(pageEnd.current);\n          }\n        }\n      }, {\n        threshold: 1\n      });\n      observer.observe(pageEnd.current);\n    }\n  }, [loading, num, term, pageNumber]);\n\n  const fetchPhotos = async (term, pageNumber) => {\n    const response = await axios.get(\"https://api.unsplash.com/search/photos/\", {\n      params: {\n        query: term,\n        page: pageNumber,\n        per_page: 10\n      },\n      headers: {\n        Authorization: \"Client-ID D8pOCh5T5EEkx0558pAommOaI3Dizrqcw524-F8LA30\"\n      }\n    });\n    setPhotos(response.data.results); // console.log(response.data);\n    // setPhotos(response.data);\n\n    setLoading(true); // console.log(response.data);\n  };\n\n  const handleChange = e => {\n    setTerm(e.target.value);\n  }; // Validation\n\n\n  const validate = () => {\n    let isValid = true;\n\n    if (term === \"\") {\n      setTermErr(\"**This field is required\");\n      isValid = false;\n    }\n\n    return isValid;\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    const isValid = validate();\n\n    if (isValid) {\n      fetchPhotos(term, pageNumber);\n      console.log(photos);\n      setTermErr(\"\");\n    }\n\n    return;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"title\",\n        children: \"Search for images you want to browse.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Happy Scrolling!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: term,\n        onChange: handleChange,\n        placeholder: \"Search here...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"empty-field-err\",\n        children: termErr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        onClick: handleSubmit,\n        children: \"Submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"result-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"photo-container\",\n        children: photos.map((photo, index) => {\n          return /*#__PURE__*/_jsxDEV(PhotoCard, {\n            image: photo\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 20\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: photos.length === 0 ? \"hide\" : \"load-button\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loading\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: loadingGif,\n            alt: \"loading animation\",\n            ref: pageEnd\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"load-more\",\n          onClick: loadMore,\n          children: \"Load More\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(App, \"KjOfIj6tA3mw5qOOO91gb9O4TZc=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","useRef","axios","loadingGif","PhotoCard","App","photos","setPhotos","term","setTerm","pageNumber","setPageNumber","termErr","setTermErr","loading","setLoading","pageEnd","loadMore","prevPageNumber","fetchPhotos","console","log","num","observer","IntersectionObserver","entries","isIntersecting","unobserve","current","threshold","observe","response","get","params","query","page","per_page","headers","Authorization","data","results","handleChange","e","target","value","validate","isValid","handleSubmit","preventDefault","map","photo","index","length"],"sources":["/media/harshiiet/File_Space 1/Work_Study/WD/React/venueMonk/infinite-scrolling/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport loadingGif from \"./loading.gif\";\nimport \"./style/App.scss\";\nimport PhotoCard from \"./PhotoCard\";\n\nfunction App() {\n  const [photos, setPhotos] = useState([]);\n  const [term, setTerm] = useState(\"\");\n  const [pageNumber, setPageNumber] = useState(1);\n  const [termErr, setTermErr] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  // attach to the element at the end of the page (loading_gif, button)\n  const pageEnd = useRef();\n  //count page loading content\n  const loadMore = () => {\n    setPageNumber((prevPageNumber) => prevPageNumber + 1);\n    fetchPhotos(term, pageNumber);\n    console.log(pageNumber);\n  };\n\n  let num = 1;\n  useEffect(() => {\n    if (loading) {\n      const observer = new IntersectionObserver(\n        (entries) => {\n          if (entries[0].isIntersecting) {\n            // console.log(\"this is the end\");\n            num++;\n            // having trouble with loadMore()*\n            setPageNumber((prevPageNumber) => prevPageNumber + 1);\n            fetchPhotos(term, pageNumber);\n            if (num >= 5) {\n              observer.unobserve(pageEnd.current);\n            }\n          }\n        },\n        { threshold: 1 }\n      );\n      observer.observe(pageEnd.current);\n    }\n  }, [loading, num, term, pageNumber]);\n\n  const fetchPhotos = async (term, pageNumber) => {\n    const response = await axios.get(\n      \"https://api.unsplash.com/search/photos/\",\n      {\n        params: {\n          query: term,\n          page: pageNumber,\n          per_page: 10,\n        },\n        headers: {\n          Authorization:\n            \"Client-ID D8pOCh5T5EEkx0558pAommOaI3Dizrqcw524-F8LA30\",\n        },\n      }\n    );\n    setPhotos(response.data.results);\n    // console.log(response.data);\n    // setPhotos(response.data);\n    setLoading(true);\n    // console.log(response.data);\n  };\n\n  const handleChange = (e) => {\n    setTerm(e.target.value);\n  };\n\n  // Validation\n  const validate = () => {\n    let isValid = true;\n    if (term === \"\") {\n      setTermErr(\"**This field is required\");\n      isValid = false;\n    }\n    return isValid;\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    const isValid = validate();\n    if (isValid) {\n      fetchPhotos(term, pageNumber);\n      console.log(photos);\n      setTermErr(\"\");\n    }\n    return;\n  };\n\n  return (\n    <>\n      <div className=\"header\">\n        <h1 className=\"title\">Search for images you want to browse.</h1>\n        <h3>Happy Scrolling!</h3>\n        <input\n          type=\"text\"\n          value={term}\n          onChange={handleChange}\n          placeholder=\"Search here...\"\n        />\n        <div className=\"empty-field-err\">{termErr}</div>\n        <button type=\"submit\" onClick={handleSubmit}>\n          Submit\n        </button>\n      </div>\n      <div className=\"result-section\">\n        <div className=\"photo-container\">\n          {photos.map((photo, index) => {\n            return <PhotoCard key={index} image={photo} />;\n          })}\n        </div>\n        <div className={photos.length === 0 ? \"hide\" : \"load-button\"}>\n          <div className=\"loading\">\n            <img src={loadingGif} alt=\"loading animation\" ref={pageEnd} />\n          </div>\n          <button className=\"load-more\" onClick={loadMore}>\n            Load More\n          </button>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}